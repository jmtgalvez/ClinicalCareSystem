<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Registration | Clicnical Care System</title>
    <link rel="stylesheet" href="new_patient_form.css">
    <style>
        * { box-sizing: border-box;}
        body {
            font-family: sans-serif;
            margin: 0;
            width: 100vw;
        }
        main {
            padding: 5%;
            margin: 0 auto;
            width: 100%;
        }
        @media screen and (min-width: 768px) {
            main { max-width: 1000px;}
        }
    </style>
</head>
<body>
    <main>
        <h1>Patient Registration Form</h1>
        <form action="patient_list.html">
            <input type="text" name="username" id="username">
            <label for="registration-date">Date:</label>
            <input type="date" name="registration-date" id="registration-date" disabled>
            <fieldset>
                <legend><h2>Personal Information</h2></legend>
                <div class="form-field name">
                    <label for="firstname">First Name</label>
                    <input type="text" name="first_name" id="firstname" placeholder="Juan" required>
                </div>
                <div class="form-field name">
                    <label for="middlename">Middle Name</label>
                    <input type="text" name="middle_name" id="middlename" placeholder="Santos" required>
                </div>
                <div class="form-field name">
                    <label for="lastname">Last Name</label>
                    <input type="text" name="last_name" id="lastname" placeholder="Dela Cruz" required>
                </div>
                <div class="form-field details">
                    <label for="birthday">Birthday</label>
                    <input type="date" name="birthday" id="birthday" required>
                </div>
                <div class="form-field details">
                    <label for="sex">Sex</label>
                    <select name="sex" id="sex" required>
                        <option value="null" disabled selected>Choose one</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                    </select>
                </div>
                <div class="form-field details">
                    <label for="civil-status">Civil Status</label>
                    <select name="civil-status" id="civil-status" required>
                        <option value="null" disabled selected>Choose one</option>
                        <option value="single">Single</option>
                        <option value="married">Married</option>
                        <option value="separated">Separated</option>
                        <option value="widow">Widow</option>
                    </select>
                </div>
                <div class="form-field">
                    <label for="street-addr">Street Address</label>
                    <input type="text" name="street-addr" id="street-addr" required>
                </div>
                <div class="form-field address">
                    <label for="province">Province</label>
                    <select name="province" id="province" class="autocomplete" required>
                        <option value=null disbaled selected>Select province</option>
                    </select>
                </div>
                <div class="form-field address">
                    <label for="city">City</label>
                    <select name="city" id="city" required>
                        <option value="null" disbaled selected>Select city</option>
                    </select>
                </div>
                <div class="form-field contacts">
                    <label for="contact-no">Contact Number</label>
                    <input type="number" name="contact-no" id="contact-no" required>
                </div>
                <div class="form-field contacts">
                    <label for="email">Email</label>
                    <input type="email" name="email" id="email">
                </div>
            </fieldset>
            <fieldset>
                <legend><h2>Emergency Contact</h2></legend>
                <div class="form-field">
                    <label for="emergency-contact-name">Name</label>
                    <input type="text" name="emergency-contact-name" id="emergency-contact-name" placeholder="Maria Dela Cruz" required>
                </div>
                <div class="form-field contacts">
                    <label for="emergency-contact-no">Contact Number</label>
                    <input type="number" name="emergency-contact-no" id="emergency-contact-no" required>
                </div>
                <div class="form-field contacts">
                    <label for="emergency-contact-email">Email</label>
                    <input type="email" name="emergency-contact-email" id="emergency-contact-email">
                </div>
                <div class="form-field">
                    <label for="emergency-contact-addr">Complete Address</label>
                    <input type="text" name="emergency-contact-addr" id="emergency-contact-addr" required>
                </div>
            </fieldset>
            <fieldset>
                <legend><h2>Medical History</h2></legend>
                <div class="form-field">
                    Add a record for every diagnosis.
                </div>
                <fieldset class="form-field">
                    <legend><b>Medical Record</b></legend>
                    <div class="form-field">
                        <label for="diagnosis">Diagnosis</label>
                        <input type="text" name="diagnosis" id="diagnosis" placeholder="n/a">
                    </div>
                    <div class="form-field">
                        <label for="diagnosis-date">Date of Diagnosis</label>
                        <input type="date" name="diagnosis-date" id="diagnosis-date" disabled>
                    </div>
                    <div class="form-field contacts">
                        <label for="diagnosis-doctor">Doctor's Name</label>
                        <input type="text" name="diagnosis-doctor" id="diagnosis-doctor" disabled>
                    </div>
                    <div class="form-field contacts">
                        <label for="diagnosis-doctor-contact">Doctor's Contact No.</label>
                        <input type="number" name="diagnosis-doctor-contact" id="diagnosis-doctor-contact" disabled>
                    </div>
                </fieldset>
                <div class="form-field">
                    <button onclick="">Add Medical Record</button>
                </div>
            </fieldset>
            <input type="submit" value="Add Patient">
            <input type="reset" value="Clear Form">
        </form>
    </main>

    <script>
        const USERNAME = new URLSearchParams(window.location.search).get("username")
        document.getElementById("username").value = USERNAME
        document.getElementById("username").style.display = "none"
        
        const TODAY = new Date();
        document.querySelector(`#registration-date`).value = formatDateToyyyyMMdd(TODAY.toDateString());
        document.querySelector(`#birthday`).max = formatDateToyyyyMMdd(TODAY.toDateString());

        function formatDateToyyyyMMdd(date) {
            const MONTHS = {
                "Jan": "01",
                "Feb": "02",
                "Mar": "03",
                "Apr": "04",
                "May": "05",
                "Jun": "06",
                "Jul": "07",
                "Aug": "08",
                "Sep": "09",
                "Oct": "10",
                "Nov": "11",
                "Dec": "12"
            }
            dateArr = date.split(" ")
            return `${dateArr[3]}-${MONTHS[dateArr[1]]}-${dateArr[2]}`
        }
    </script>
    <script src="cities.js"></script>
</body>
</html>